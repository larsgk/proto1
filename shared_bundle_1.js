define(["exports"],function(_exports){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.removeNodesFromTemplate=removeNodesFromTemplate;_exports.insertNodeIntoTemplate=insertNodeIntoTemplate;_exports.render$1=render;_exports.render$2=render$2;_exports.templateFactory$1=_exports.templateFactory=templateFactory;_exports.createMarker$1=_exports.createMarker=_exports.isTemplatePartActive$1=_exports.isTemplatePartActive=_exports.Template$1=_exports.Template=_exports.rewritesStyleAttribute$1=_exports.rewritesStyleAttribute=_exports.markerRegex$1=_exports.markerRegex=_exports.nodeMarker$1=_exports.nodeMarker=_exports.marker$1=_exports.marker=_exports.SVGTemplateResult$1=_exports.SVGTemplateResult=_exports.TemplateInstance$1=_exports.TemplateInstance=_exports.templateCaches$1=_exports.templateCaches=_exports.TemplateResult$2=_exports.TemplateResult$1=_exports.TemplateResult=_exports.parts=_exports.EventPart$1=_exports.EventPart=_exports.PropertyPart$1=_exports.PropertyPart=_exports.PropertyCommitter$1=_exports.PropertyCommitter=_exports.BooleanAttributePart$1=_exports.BooleanAttributePart=_exports.NodePart$1=_exports.NodePart=_exports.AttributePart$1=_exports.AttributePart=_exports.AttributeCommitter$1=_exports.AttributeCommitter=_exports.isPrimitive$1=_exports.isPrimitive=_exports.noChange$1=_exports.noChange=_exports.removeNodes$1=_exports.removeNodes=_exports.reparentNodes$1=_exports.reparentNodes=_exports.isCEPolyfill$1=_exports.isCEPolyfill=_exports.isDirective=_exports.directive=_exports.defaultTemplateProcessor$1=_exports.defaultTemplateProcessor=_exports.DefaultTemplateProcessor$1=_exports.DefaultTemplateProcessor=_exports.LitElement=_exports.svg=_exports.svg$2=_exports.svg$1=_exports.html=_exports.html$2=_exports.html$1=_exports.UpdatingElement$1=_exports.UpdatingElement=_exports.notEqual$1=_exports.notEqual=_exports.queryAll$1=_exports.queryAll=_exports.query$1=_exports.query=_exports.property$1=_exports.property=_exports.customElement$1=_exports.customElement=_exports.$thingy52Factory=_exports.$thingy52Device=_exports.$fakeMesh=_exports.$empirikitFactory=_exports.$empirikitDevice=_exports.$dummyFactory=_exports.$dummyDevice=_exports.$defs=_exports.$controlButton=_exports.$baseDevice=_exports.$backgroundView=_exports.$litHtml=_exports.$template=_exports.$templateResult=_exports.$templateInstance=_exports.$templateFactory=_exports.$shadyRender=_exports.$render=_exports.$parts=_exports.$part=_exports.$modifyTemplate=_exports.$dom=_exports.$directive=_exports.$defaultTemplateProcessor=_exports.$litElement=_exports.$updatingElement=_exports.$decorators=void 0;_exports.Thing52Factory=_exports.Thingy52Device=_exports.Mesh=_exports.EmpiriKitFactory=_exports.EmpiriKitDevice=_exports.DummyFactory=_exports.DummyDevice=_exports.AlertLevels=_exports.ControlButton=_exports.BaseDevice=_exports.BackgroundView=_exports.lastAttributeNameRegex$1=_exports.lastAttributeNameRegex=void 0;var _Mathround=Math.round;const customElement=tagName=>clazz=>{window.customElements.define(tagName,clazz);return clazz};_exports.customElement$1=_exports.customElement=customElement;const property=options=>(proto,name)=>{proto.constructor.createProperty(name,options)};_exports.property$1=_exports.property=property;const query=_query((target,selector)=>target.querySelector(selector));_exports.query$1=_exports.query=query;const queryAll=_query((target,selector)=>target.querySelectorAll(selector));_exports.queryAll$1=_exports.queryAll=queryAll;function _query(queryFn){return selector=>(proto,propName)=>{Object.defineProperty(proto,propName,{get(){return queryFn(this.renderRoot,selector)},enumerable:!0,configurable:!0})}}_exports.$decorators={customElement:customElement,property:property,query:query,queryAll:queryAll};const fromBooleanAttribute=value=>null!==value,toBooleanAttribute=value=>value?"":null,notEqual=(value,old)=>{return old!==value&&(old===old||value===value)};_exports.notEqual$1=_exports.notEqual=notEqual;const defaultPropertyDeclaration={attribute:!0,type:String,reflect:!1,hasChanged:notEqual},microtaskPromise=new Promise(resolve=>resolve(!0)),STATE_HAS_UPDATED=1,STATE_UPDATE_REQUESTED=1<<2,STATE_IS_REFLECTING=1<<3;class UpdatingElement extends HTMLElement{constructor(){super();this._updateState=0;this._instanceProperties=void 0;this._updatePromise=microtaskPromise;this._changedProperties=new Map;this._reflectingProperties=void 0;this.initialize()}static get observedAttributes(){this._finalize();const attributes=[];for(const[p,v]of this._classProperties){const attr=this._attributeNameForProperty(p,v);if(attr!==void 0){this._attributeToPropertyMap.set(attr,p);attributes.push(attr)}}return attributes}static createProperty(name,options=defaultPropertyDeclaration){if(!this.hasOwnProperty("_classProperties")){this._classProperties=new Map;const superProperties=Object.getPrototypeOf(this)._classProperties;if(superProperties!==void 0){superProperties.forEach((v,k)=>this._classProperties.set(k,v))}}this._classProperties.set(name,options);if(this.prototype.hasOwnProperty(name)){return}const key="symbol"===typeof name?Symbol():`__${name}`;Object.defineProperty(this.prototype,name,{get(){return this[key]},set(value){const oldValue=this[name];this[key]=value;this._requestPropertyUpdate(name,oldValue,options)},configurable:!0,enumerable:!0})}static _finalize(){if(this.hasOwnProperty("_finalized")&&this._finalized){return}const superCtor=Object.getPrototypeOf(this);if("function"===typeof superCtor._finalize){superCtor._finalize()}this._finalized=!0;this._attributeToPropertyMap=new Map;const props=this.properties,propKeys=[...Object.getOwnPropertyNames(props),...("function"===typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(props):[])];for(const p of propKeys){this.createProperty(p,props[p])}}static _attributeNameForProperty(name,options){const attribute=options!==void 0&&options.attribute;return!1===attribute?void 0:"string"===typeof attribute?attribute:"string"===typeof name?name.toLowerCase():void 0}static _valueHasChanged(value,old,hasChanged=notEqual){return hasChanged(value,old)}static _propertyValueFromAttribute(value,options){const type=options&&options.type;if(type===void 0){return value}const fromAttribute=type===Boolean?fromBooleanAttribute:"function"===typeof type?type:type.fromAttribute;return fromAttribute?fromAttribute(value):value}static _propertyValueToAttribute(value,options){if(options===void 0||options.reflect===void 0){return}const toAttribute=options.type===Boolean?toBooleanAttribute:options.type&&options.type.toAttribute||String;return toAttribute(value)}initialize(){this.renderRoot=this.createRenderRoot();this._saveInstanceProperties()}_saveInstanceProperties(){for(const[p]of this.constructor._classProperties){if(this.hasOwnProperty(p)){const value=this[p];delete this[p];if(!this._instanceProperties){this._instanceProperties=new Map}this._instanceProperties.set(p,value)}}}_applyInstanceProperties(){for(const[p,v]of this._instanceProperties){this[p]=v}this._instanceProperties=void 0}createRenderRoot(){return this.attachShadow({mode:"open"})}connectedCallback(){if(this._updateState&STATE_HAS_UPDATED){if(window.ShadyCSS!==void 0){window.ShadyCSS.styleElement(this)}}else{this.requestUpdate()}}attributeChangedCallback(name,old,value){if(old!==value){this._attributeToProperty(name,value)}}_propertyToAttribute(name,value,options=defaultPropertyDeclaration){const ctor=this.constructor,attrValue=ctor._propertyValueToAttribute(value,options);if(attrValue!==void 0){const attr=ctor._attributeNameForProperty(name,options);if(attr!==void 0){this._updateState=this._updateState|STATE_IS_REFLECTING;if(null===attrValue){this.removeAttribute(attr)}else{this.setAttribute(attr,attrValue)}this._updateState=this._updateState&~STATE_IS_REFLECTING}}}_attributeToProperty(name,value){if(!(this._updateState&STATE_IS_REFLECTING)){const ctor=this.constructor,propName=ctor._attributeToPropertyMap.get(name);if(propName!==void 0){const options=ctor._classProperties.get(propName);this[propName]=ctor._propertyValueFromAttribute(value,options)}}}requestUpdate(name,oldValue){if(name!==void 0){const options=this.constructor._classProperties.get(name)||defaultPropertyDeclaration;return this._requestPropertyUpdate(name,oldValue,options)}return this._invalidate()}_requestPropertyUpdate(name,oldValue,options){if(!this.constructor._valueHasChanged(this[name],oldValue,options.hasChanged)){return this.updateComplete}if(!this._changedProperties.has(name)){this._changedProperties.set(name,oldValue)}if(!0===options.reflect){if(this._reflectingProperties===void 0){this._reflectingProperties=new Map}this._reflectingProperties.set(name,options)}return this._invalidate()}_invalidate(){var _this=this;return babelHelpers.asyncToGenerator(function*(){if(!_this._hasRequestedUpdate){_this._updateState=_this._updateState|STATE_UPDATE_REQUESTED;let resolver;const previousValidatePromise=_this._updatePromise;_this._updatePromise=new Promise(r=>resolver=r);yield previousValidatePromise;_this._validate();resolver(!_this._hasRequestedUpdate)}return _this.updateComplete})()}get _hasRequestedUpdate(){return this._updateState&STATE_UPDATE_REQUESTED}_validate(){if(this._instanceProperties){this._applyInstanceProperties()}if(this.shouldUpdate(this._changedProperties)){const changedProperties=this._changedProperties;this.update(changedProperties);this._markUpdated();if(!(this._updateState&STATE_HAS_UPDATED)){this._updateState=this._updateState|STATE_HAS_UPDATED;this.firstUpdated(changedProperties)}this.updated(changedProperties)}else{this._markUpdated()}}_markUpdated(){this._changedProperties=new Map;this._updateState=this._updateState&~STATE_UPDATE_REQUESTED}get updateComplete(){return this._updatePromise}shouldUpdate(){return!0}update(){if(this._reflectingProperties!==void 0&&0<this._reflectingProperties.size){for(const[k,v]of this._reflectingProperties){this._propertyToAttribute(k,this[k],v)}this._reflectingProperties=void 0}}updated(){}firstUpdated(){}}_exports.UpdatingElement$1=_exports.UpdatingElement=UpdatingElement;UpdatingElement._attributeToPropertyMap=new Map;UpdatingElement._finalized=!0;UpdatingElement._classProperties=new Map;UpdatingElement.properties={};_exports.$updatingElement={notEqual:notEqual,UpdatingElement:UpdatingElement};const marker=`{{lit-${(Math.random()+"").slice(2)}}}`;_exports.marker$1=_exports.marker=marker;const nodeMarker=`<!--${marker}-->`;_exports.nodeMarker$1=_exports.nodeMarker=nodeMarker;const markerRegex=new RegExp(`${marker}|${nodeMarker}`);_exports.markerRegex$1=_exports.markerRegex=markerRegex;const rewritesStyleAttribute=(()=>{const el=document.createElement("div");el.setAttribute("style","{{bad value}}");return"{{bad value}}"!==el.getAttribute("style")})();_exports.rewritesStyleAttribute$1=_exports.rewritesStyleAttribute=rewritesStyleAttribute;class Template{constructor(result,element){this.parts=[];this.element=element;let index=-1,partIndex=0;const nodesToRemove=[],_prepareTemplate=template=>{const content=template.content,walker=document.createTreeWalker(content,133,null,!1);let previousNode,currentNode;while(walker.nextNode()){index++;previousNode=currentNode;const node=currentNode=walker.currentNode;if(1===node.nodeType){if(node.hasAttributes()){const attributes=node.attributes;let count=0;for(let i=0;i<attributes.length;i++){if(0<=attributes[i].value.indexOf(marker)){count++}}while(0<count--){const stringForPart=result.strings[partIndex],name=lastAttributeNameRegex.exec(stringForPart)[2],attributeLookupName=rewritesStyleAttribute&&"style"===name?"style$":/^[a-zA-Z-]*$/.test(name)?name:name.toLowerCase(),attributeValue=node.getAttribute(attributeLookupName),strings=attributeValue.split(markerRegex);this.parts.push({type:"attribute",index,name,strings});node.removeAttribute(attributeLookupName);partIndex+=strings.length-1}}if("TEMPLATE"===node.tagName){_prepareTemplate(node)}}else if(3===node.nodeType){const nodeValue=node.nodeValue;if(0>nodeValue.indexOf(marker)){continue}const parent=node.parentNode,strings=nodeValue.split(markerRegex),lastIndex=strings.length-1;partIndex+=lastIndex;for(let i=0;i<lastIndex;i++){parent.insertBefore(""===strings[i]?createMarker():document.createTextNode(strings[i]),node);this.parts.push({type:"node",index:index++})}parent.insertBefore(""===strings[lastIndex]?createMarker():document.createTextNode(strings[lastIndex]),node);nodesToRemove.push(node)}else if(8===node.nodeType){if(node.nodeValue===marker){const parent=node.parentNode,previousSibling=node.previousSibling;if(null===previousSibling||previousSibling!==previousNode||previousSibling.nodeType!==Node.TEXT_NODE){parent.insertBefore(createMarker(),node)}else{index--}this.parts.push({type:"node",index:index++});nodesToRemove.push(node);if(null===node.nextSibling){parent.insertBefore(createMarker(),node)}else{index--}currentNode=previousNode;partIndex++}else{let i=-1;while(-1!==(i=node.nodeValue.indexOf(marker,i+1))){this.parts.push({type:"node",index:-1})}}}}};_prepareTemplate(element);for(const n of nodesToRemove){n.parentNode.removeChild(n)}}}_exports.Template$1=_exports.Template=Template;const isTemplatePartActive=part=>-1!==part.index;_exports.isTemplatePartActive$1=_exports.isTemplatePartActive=isTemplatePartActive;const createMarker=()=>document.createComment("");_exports.createMarker$1=_exports.createMarker=createMarker;const lastAttributeNameRegex=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F \x09\x0a\x0c\x0d"'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;_exports.lastAttributeNameRegex$1=_exports.lastAttributeNameRegex=lastAttributeNameRegex;_exports.$template={marker:marker,nodeMarker:nodeMarker,markerRegex:markerRegex,rewritesStyleAttribute:rewritesStyleAttribute,Template:Template,isTemplatePartActive:isTemplatePartActive,createMarker:createMarker,lastAttributeNameRegex:lastAttributeNameRegex};const walkerNodeFilter=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT;function removeNodesFromTemplate(template,nodesToRemove){const{element:{content},parts}=template,walker=document.createTreeWalker(content,walkerNodeFilter,null,!1);let partIndex=nextActiveIndexInTemplateParts(parts),part=parts[partIndex],nodeIndex=-1,removeCount=0;const nodesToRemoveInTemplate=[];let currentRemovingNode=null;while(walker.nextNode()){nodeIndex++;const node=walker.currentNode;if(node.previousSibling===currentRemovingNode){currentRemovingNode=null}if(nodesToRemove.has(node)){nodesToRemoveInTemplate.push(node);if(null===currentRemovingNode){currentRemovingNode=node}}if(null!==currentRemovingNode){removeCount++}while(part!==void 0&&part.index===nodeIndex){part.index=null!==currentRemovingNode?-1:part.index-removeCount;partIndex=nextActiveIndexInTemplateParts(parts,partIndex);part=parts[partIndex]}}nodesToRemoveInTemplate.forEach(n=>n.parentNode.removeChild(n))}const countNodes=node=>{let count=node.nodeType===Node.DOCUMENT_FRAGMENT_NODE?0:1;const walker=document.createTreeWalker(node,walkerNodeFilter,null,!1);while(walker.nextNode()){count++}return count},nextActiveIndexInTemplateParts=(parts,startIndex=-1)=>{for(let i=startIndex+1;i<parts.length;i++){const part=parts[i];if(isTemplatePartActive(part)){return i}}return-1};function insertNodeIntoTemplate(template,node,refNode=null){const{element:{content},parts}=template;if(null===refNode||refNode===void 0){content.appendChild(node);return}const walker=document.createTreeWalker(content,walkerNodeFilter,null,!1);let partIndex=nextActiveIndexInTemplateParts(parts),insertCount=0,walkerIndex=-1;while(walker.nextNode()){walkerIndex++;const walkerNode=walker.currentNode;if(walkerNode===refNode){insertCount=countNodes(node);refNode.parentNode.insertBefore(node,refNode)}while(-1!==partIndex&&parts[partIndex].index===walkerIndex){if(0<insertCount){while(-1!==partIndex){parts[partIndex].index+=insertCount;partIndex=nextActiveIndexInTemplateParts(parts,partIndex)}return}partIndex=nextActiveIndexInTemplateParts(parts,partIndex)}}}_exports.$modifyTemplate={removeNodesFromTemplate:removeNodesFromTemplate,insertNodeIntoTemplate:insertNodeIntoTemplate};const isCEPolyfill=window.customElements!==void 0&&window.customElements.polyfillWrapFlushCallback!==void 0;_exports.isCEPolyfill$1=_exports.isCEPolyfill=isCEPolyfill;const reparentNodes=(container,start,end=null,before=null)=>{let node=start;while(node!==end){const n=node.nextSibling;container.insertBefore(node,before);node=n}};_exports.reparentNodes$1=_exports.reparentNodes=reparentNodes;const removeNodes=(container,startNode,endNode=null)=>{let node=startNode;while(node!==endNode){const n=node.nextSibling;container.removeChild(node);node=n}};_exports.removeNodes$1=_exports.removeNodes=removeNodes;_exports.$dom={isCEPolyfill:isCEPolyfill,reparentNodes:reparentNodes,removeNodes:removeNodes};const directives=new WeakMap,directive=f=>{directives.set(f,!0);return f};_exports.directive=directive;const isDirective=o=>"function"===typeof o&&directives.has(o);_exports.isDirective=isDirective;_exports.$directive={directive:directive,isDirective:isDirective};const noChange={};_exports.noChange$1=_exports.noChange=noChange;_exports.$part={noChange:noChange};class TemplateInstance{constructor(template,processor,getTemplate){this._parts=[];this.template=template;this.processor=processor;this._getTemplate=getTemplate}update(values){let i=0;for(const part of this._parts){if(part!==void 0){part.setValue(values[i])}i++}for(const part of this._parts){if(part!==void 0){part.commit()}}}_clone(){const fragment=isCEPolyfill?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),parts=this.template.parts;let partIndex=0,nodeIndex=0;const _prepareInstance=fragment=>{const walker=document.createTreeWalker(fragment,133,null,!1);let node=walker.nextNode();while(partIndex<parts.length&&null!==node){const part=parts[partIndex];if(!isTemplatePartActive(part)){this._parts.push(void 0);partIndex++}else if(nodeIndex===part.index){if("node"===part.type){const part=this.processor.handleTextExpression(this._getTemplate);part.insertAfterNode(node);this._parts.push(part)}else{this._parts.push(...this.processor.handleAttributeExpressions(node,part.name,part.strings))}partIndex++}else{nodeIndex++;if("TEMPLATE"===node.nodeName){_prepareInstance(node.content)}node=walker.nextNode()}}};_prepareInstance(fragment);if(isCEPolyfill){document.adoptNode(fragment);customElements.upgrade(fragment)}return fragment}}_exports.TemplateInstance$1=_exports.TemplateInstance=TemplateInstance;_exports.$templateInstance={TemplateInstance:TemplateInstance};class TemplateResult{constructor(strings,values,type,processor){this.strings=strings;this.values=values;this.type=type;this.processor=processor}getHTML(){const l=this.strings.length-1;let html="",isTextBinding=!0;for(let i=0;i<l;i++){const s=this.strings[i];html+=s;const close=s.lastIndexOf(">");isTextBinding=(-1<close||isTextBinding)&&-1===s.indexOf("<",close+1);if(!isTextBinding&&rewritesStyleAttribute){html=html.replace(lastAttributeNameRegex,(match,p1,p2,p3)=>{return"style"===p2?`${p1}style$${p3}`:match})}html+=isTextBinding?nodeMarker:marker}html+=this.strings[l];return html}getTemplateElement(){const template=document.createElement("template");template.innerHTML=this.getHTML();return template}}_exports.TemplateResult$2=_exports.TemplateResult$1=_exports.TemplateResult=TemplateResult;class SVGTemplateResult extends TemplateResult{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const template=super.getTemplateElement(),content=template.content,svgElement=content.firstChild;content.removeChild(svgElement);reparentNodes(content,svgElement.firstChild);return template}}_exports.SVGTemplateResult$1=_exports.SVGTemplateResult=SVGTemplateResult;_exports.$templateResult={TemplateResult:TemplateResult,SVGTemplateResult:SVGTemplateResult};const isPrimitive=value=>null===value||!("object"===typeof value||"function"===typeof value);_exports.isPrimitive$1=_exports.isPrimitive=isPrimitive;class AttributeCommitter{constructor(element,name,strings){this.dirty=!0;this.element=element;this.name=name;this.strings=strings;this.parts=[];for(let i=0;i<strings.length-1;i++){this.parts[i]=this._createPart()}}_createPart(){return new AttributePart(this)}_getValue(){const strings=this.strings,l=strings.length-1;let text="";for(let i=0;i<l;i++){text+=strings[i];const part=this.parts[i];if(part!==void 0){const v=part.value;if(null!=v&&(Array.isArray(v)||"string"!==typeof v&&v[Symbol.iterator])){for(const t of v){text+="string"===typeof t?t:t+""}}else{text+="string"===typeof v?v:v+""}}}text+=strings[l];return text}commit(){if(this.dirty){this.dirty=!1;this.element.setAttribute(this.name,this._getValue())}}}_exports.AttributeCommitter$1=_exports.AttributeCommitter=AttributeCommitter;class AttributePart{constructor(comitter){this.value=void 0;this.committer=comitter}setValue(value){if(value!==noChange&&(!isPrimitive(value)||value!==this.value)){this.value=value;if(!isDirective(value)){this.committer.dirty=!0}}}commit(){while(isDirective(this.value)){const directive$$1=this.value;this.value=noChange;directive$$1(this)}if(this.value===noChange){return}this.committer.commit()}}_exports.AttributePart$1=_exports.AttributePart=AttributePart;class NodePart{constructor(templateFactory){this.value=void 0;this._pendingValue=void 0;this.templateFactory=templateFactory}appendInto(container){this.startNode=container.appendChild(createMarker());this.endNode=container.appendChild(createMarker())}insertAfterNode(ref){this.startNode=ref;this.endNode=ref.nextSibling}appendIntoPart(part){part._insert(this.startNode=createMarker());part._insert(this.endNode=createMarker())}insertAfterPart(ref){ref._insert(this.startNode=createMarker());this.endNode=ref.endNode;ref.endNode=this.startNode}setValue(value){this._pendingValue=value}commit(){while(isDirective(this._pendingValue)){const directive$$1=this._pendingValue;this._pendingValue=noChange;directive$$1(this)}const value=this._pendingValue;if(value===noChange){return}if(isPrimitive(value)){if(value!==this.value){this._commitText(value)}}else if(value instanceof TemplateResult){this._commitTemplateResult(value)}else if(value instanceof Node){this._commitNode(value)}else if(Array.isArray(value)||value[Symbol.iterator]){this._commitIterable(value)}else if(value.then!==void 0){this._commitPromise(value)}else{this._commitText(value)}}_insert(node){this.endNode.parentNode.insertBefore(node,this.endNode)}_commitNode(value){if(this.value===value){return}this.clear();this._insert(value);this.value=value}_commitText(value){const node=this.startNode.nextSibling;value=null==value?"":value;if(node===this.endNode.previousSibling&&node.nodeType===Node.TEXT_NODE){node.textContent=value}else{this._commitNode(document.createTextNode("string"===typeof value?value:value+""))}this.value=value}_commitTemplateResult(value){const template=this.templateFactory(value);if(this.value&&this.value.template===template){this.value.update(value.values)}else{const instance=new TemplateInstance(template,value.processor,this.templateFactory),fragment=instance._clone();instance.update(value.values);this._commitNode(fragment);this.value=instance}}_commitIterable(value){if(!Array.isArray(this.value)){this.value=[];this.clear()}const itemParts=this.value;let partIndex=0,itemPart;for(const item of value){itemPart=itemParts[partIndex];if(itemPart===void 0){itemPart=new NodePart(this.templateFactory);itemParts.push(itemPart);if(0===partIndex){itemPart.appendIntoPart(this)}else{itemPart.insertAfterPart(itemParts[partIndex-1])}}itemPart.setValue(item);itemPart.commit();partIndex++}if(partIndex<itemParts.length){itemParts.length=partIndex;this.clear(itemPart&&itemPart.endNode)}}_commitPromise(value){this.value=value;value.then(v=>{if(this.value===value){this.setValue(v);this.commit()}})}clear(startNode=this.startNode){removeNodes(this.startNode.parentNode,startNode.nextSibling,this.endNode)}}_exports.NodePart$1=_exports.NodePart=NodePart;class BooleanAttributePart{constructor(element,name,strings){this.value=void 0;this._pendingValue=void 0;if(2!==strings.length||""!==strings[0]||""!==strings[1]){throw new Error("Boolean attributes can only contain a single expression")}this.element=element;this.name=name;this.strings=strings}setValue(value){this._pendingValue=value}commit(){while(isDirective(this._pendingValue)){const directive$$1=this._pendingValue;this._pendingValue=noChange;directive$$1(this)}if(this._pendingValue===noChange){return}const value=!!this._pendingValue;if(this.value!==value){if(value){this.element.setAttribute(this.name,"")}else{this.element.removeAttribute(this.name)}}this.value=value;this._pendingValue=noChange}}_exports.BooleanAttributePart$1=_exports.BooleanAttributePart=BooleanAttributePart;class PropertyCommitter extends AttributeCommitter{constructor(element,name,strings){super(element,name,strings);this.single=2===strings.length&&""===strings[0]&&""===strings[1]}_createPart(){return new PropertyPart(this)}_getValue(){if(this.single){return this.parts[0].value}return super._getValue()}commit(){if(this.dirty){this.dirty=!1;this.element[this.name]=this._getValue()}}}_exports.PropertyCommitter$1=_exports.PropertyCommitter=PropertyCommitter;class PropertyPart extends AttributePart{}_exports.PropertyPart$1=_exports.PropertyPart=PropertyPart;class EventPart{constructor(element,eventName){this.value=void 0;this._pendingValue=void 0;this.element=element;this.eventName=eventName}setValue(value){this._pendingValue=value}commit(){while(isDirective(this._pendingValue)){const directive$$1=this._pendingValue;this._pendingValue=noChange;directive$$1(this)}if(this._pendingValue===noChange){return}if(null==this._pendingValue!==(null==this.value)){if(null==this._pendingValue){this.element.removeEventListener(this.eventName,this)}else{this.element.addEventListener(this.eventName,this)}}this.value=this._pendingValue;this._pendingValue=noChange}handleEvent(event){if("function"===typeof this.value){this.value.call(this.element,event)}else if("function"===typeof this.value.handleEvent){this.value.handleEvent(event)}}}_exports.EventPart$1=_exports.EventPart=EventPart;_exports.$parts={isPrimitive:isPrimitive,AttributeCommitter:AttributeCommitter,AttributePart:AttributePart,NodePart:NodePart,BooleanAttributePart:BooleanAttributePart,PropertyCommitter:PropertyCommitter,PropertyPart:PropertyPart,EventPart:EventPart};function templateFactory(result){let templateCache=templateCaches.get(result.type);if(templateCache===void 0){templateCache=new Map;templateCaches.set(result.type,templateCache)}let template=templateCache.get(result.strings);if(template===void 0){template=new Template(result,result.getTemplateElement());templateCache.set(result.strings,template)}return template}const templateCaches=new Map;_exports.templateCaches$1=_exports.templateCaches=templateCaches;_exports.$templateFactory={templateFactory:templateFactory,templateCaches:templateCaches};const parts$1=new WeakMap;_exports.parts=parts$1;function render(result,container,templateFactory$$1=templateFactory){let part=parts$1.get(container);if(part===void 0){removeNodes(container,container.firstChild);parts$1.set(container,part=new NodePart(templateFactory$$1));part.appendInto(container)}part.setValue(result);part.commit()}_exports.$render={parts:parts$1,render:render};class DefaultTemplateProcessor{handleAttributeExpressions(element,name,strings){const prefix=name[0];if("."===prefix){const comitter=new PropertyCommitter(element,name.slice(1),strings);return comitter.parts}if("@"===prefix){return[new EventPart(element,name.slice(1))]}if("?"===prefix){return[new BooleanAttributePart(element,name.slice(1),strings)]}const comitter=new AttributeCommitter(element,name,strings);return comitter.parts}handleTextExpression(templateFactory){return new NodePart(templateFactory)}}_exports.DefaultTemplateProcessor$1=_exports.DefaultTemplateProcessor=DefaultTemplateProcessor;const defaultTemplateProcessor=new DefaultTemplateProcessor;_exports.defaultTemplateProcessor$1=_exports.defaultTemplateProcessor=defaultTemplateProcessor;_exports.$defaultTemplateProcessor={DefaultTemplateProcessor:DefaultTemplateProcessor,defaultTemplateProcessor:defaultTemplateProcessor};const html=(strings,...values)=>new TemplateResult(strings,values,"html",defaultTemplateProcessor);_exports.html=_exports.html$2=_exports.html$1=html;const svg=(strings,...values)=>new SVGTemplateResult(strings,values,"svg",defaultTemplateProcessor);_exports.svg=_exports.svg$2=_exports.svg$1=svg;_exports.$litHtml={html:html,svg:svg,TemplateResult:TemplateResult,SVGTemplateResult:SVGTemplateResult,marker:marker,nodeMarker:nodeMarker,markerRegex:markerRegex,rewritesStyleAttribute:rewritesStyleAttribute,Template:Template,isTemplatePartActive:isTemplatePartActive,createMarker:createMarker,lastAttributeNameRegex:lastAttributeNameRegex,DefaultTemplateProcessor:DefaultTemplateProcessor,defaultTemplateProcessor:defaultTemplateProcessor,TemplateInstance:TemplateInstance,noChange:noChange,isPrimitive:isPrimitive,AttributeCommitter:AttributeCommitter,AttributePart:AttributePart,NodePart:NodePart,BooleanAttributePart:BooleanAttributePart,PropertyCommitter:PropertyCommitter,PropertyPart:PropertyPart,EventPart:EventPart,isCEPolyfill:isCEPolyfill,reparentNodes:reparentNodes,removeNodes:removeNodes,directive:directive,isDirective:isDirective,parts:parts$1,render:render,templateFactory:templateFactory,templateCaches:templateCaches};const getTemplateCacheKey=(type,scopeName)=>`${type}--${scopeName}`;let compatibleShadyCSSVersion=!0;if("undefined"===typeof window.ShadyCSS){compatibleShadyCSSVersion=!1}else if("undefined"===typeof window.ShadyCSS.prepareTemplateDom){console.warn(`Incompatible ShadyCSS version detected.`+`Please update to at least @webcomponents/webcomponentsjs@2.0.2 and`+`@webcomponents/shadycss@1.3.1.`);compatibleShadyCSSVersion=!1}const shadyTemplateFactory=scopeName=>result=>{const cacheKey=getTemplateCacheKey(result.type,scopeName);let templateCache=templateCaches.get(cacheKey);if(templateCache===void 0){templateCache=new Map;templateCaches.set(cacheKey,templateCache)}let template=templateCache.get(result.strings);if(template===void 0){const element=result.getTemplateElement();if(compatibleShadyCSSVersion){window.ShadyCSS.prepareTemplateDom(element,scopeName)}template=new Template(result,element);templateCache.set(result.strings,template)}return template},TEMPLATE_TYPES=["html","svg"];function removeStylesFromLitTemplates(scopeName){TEMPLATE_TYPES.forEach(type=>{const templates=templateCaches.get(getTemplateCacheKey(type,scopeName));if(templates!==void 0){templates.forEach(template=>{const{element:{content}}=template,styles=new Set;Array.from(content.querySelectorAll("style")).forEach(s=>{styles.add(s)});removeNodesFromTemplate(template,styles)})}})}const shadyRenderSet=new Set,prepareTemplateStyles=(renderedDOM,template,scopeName)=>{shadyRenderSet.add(scopeName);const styles=renderedDOM.querySelectorAll("style");if(0===styles.length){return}const condensedStyle=document.createElement("style");for(let i=0;i<styles.length;i++){const style=styles[i];style.parentNode.removeChild(style);condensedStyle.textContent+=style.textContent}removeStylesFromLitTemplates(scopeName);insertNodeIntoTemplate(template,condensedStyle,template.element.content.firstChild);window.ShadyCSS.prepareTemplateStyles(template.element,scopeName);if(window.ShadyCSS.nativeShadow){const style=template.element.content.querySelector("style");renderedDOM.insertBefore(style.cloneNode(!0),renderedDOM.firstChild)}else{template.element.content.insertBefore(condensedStyle,template.element.content.firstChild);const removes=new Set([condensedStyle]);removeNodesFromTemplate(template,removes)}};function render$2(result,container,scopeName){const hasRendered=parts$1.has(container);render(result,container,shadyTemplateFactory(scopeName));if(container instanceof ShadowRoot&&compatibleShadyCSSVersion&&result instanceof TemplateResult){if(!shadyRenderSet.has(scopeName)){const part=parts$1.get(container),instance=part.value;prepareTemplateStyles(container,instance.template,scopeName)}if(!hasRendered){window.ShadyCSS.styleElement(container.host)}}}_exports.$shadyRender={render:render$2,html:html,svg:svg,TemplateResult:TemplateResult};class LitElement extends UpdatingElement{update(changedProperties){super.update(changedProperties);if("function"===typeof this.render){this.constructor.render(this.render(),this.renderRoot,this.localName)}else{throw new Error("render() not implemented")}}}_exports.LitElement=LitElement;LitElement.render=render$2;_exports.$litElement={LitElement:LitElement,html:html,svg:svg,notEqual:notEqual,UpdatingElement:UpdatingElement,customElement:customElement,property:property,query:query,queryAll:queryAll};const AlertLevels=[{name:"LOW",color:"#004040"},{name:"NORMAL",color:"#00ff00"},{name:"RAISED",color:"#ffff00"},{name:"HIGH",color:"#ff8000"},{name:"SEVERE",color:"#ff0000"}];_exports.AlertLevels=AlertLevels;_exports.$defs={AlertLevels:AlertLevels};class BaseDevice extends EventTarget{constructor(type,localId){super();this.deviceType=type;this.deviceId=`${this.deviceType}:${localId}`;this._alertLevel=1;this.setAlertLevel=this.setAlertLevel.bind(this);this.getAlertLevel=this.getAlertLevel.bind(this);this._loadStateInfo()}_loadStateInfo(){const _dbStateStr=localStorage.getItem(`state_${this.deviceId}`);let _dbstate={};if(_dbStateStr){try{_dbstate=JSON.parse(_dbStateStr)}catch(e){console.log(e)}}this._state={name:_dbstate.name||"Unknown"}}_storeStateInfo(){localStorage.setItem(`state_${this.deviceId}`,JSON.stringify(this._state))}setStateValue(key,value){this.dispatchEvent(new CustomEvent("debug-state-value-changed",{detail:{key:key,from:this._state[key],to:value}}));this._state[key]=value;this._storeStateInfo()}getStateValue(key){return this._state[key]}initialize(){throw`${typeof this}.initialize() not implemented!`}emitDeviceReady(){this.dispatchEvent(new CustomEvent("ready"))}emitDeviceDisconnected(){this._storeStateInfo();this.dispatchEvent(new CustomEvent("disconnect"))}emitDebugData(data){this.dispatchEvent(new CustomEvent("debug-data",{detail:data}))}emitDebugAlertLevel(level){this.dispatchEvent(new CustomEvent("debug-alert-level",{detail:{level:level,visual:AlertLevels[level]}}))}setAlertLevel(level){this._alertLevel=level;const alertVal=AlertLevels[level];if(alertVal&&this._setRGB!==void 0){this._setRGB(alertVal.color)}this.emitDebugAlertLevel(level)}getAlertLevel(){return this._alertLevel}}_exports.BaseDevice=BaseDevice;_exports.$baseDevice={BaseDevice:BaseDevice};class DummyDevice extends BaseDevice{constructor(){super("Dummy",Date.now().toString());this.initialize=this.initialize.bind(this);this._onHeartbeat=this._onHeartbeat.bind(this);this._deviceDisconnected=this._deviceDisconnected.bind(this)}initialize(){var _this2=this;return babelHelpers.asyncToGenerator(function*(){console.log(`Initializing ${_this2.deviceType} device with id: ${_this2.deviceId}`);_this2._beatCount=0;if("Unknown"===_this2.getStateValue("name")){setTimeout(()=>{_this2.setStateValue("name",["DummyA","DummyB","DummyC"][Math.floor(3*Math.random())])},3e3)}_this2.emitDeviceReady()})()}disconnect(){setTimeout(this._deviceDisconnected)}_deviceDisconnected(){console.log(`Disconnected: ${this.deviceId}`);this.emitDeviceDisconnected()}_onHeartbeat(){this.emitDebugData({type:"heartbeat",value:++this._beatCount})}_setRGB(){}}_exports.DummyDevice=DummyDevice;_exports.$dummyDevice={DummyDevice:DummyDevice};class _Factory extends EventTarget{constructor(){super();this.type="Dummy";console.log(`Created factory for: ${this.type}`)}scan(){var _this3=this;return babelHelpers.asyncToGenerator(function*(){setTimeout(()=>{const device=new DummyDevice;_this3.dispatchEvent(new CustomEvent("connect",{detail:{device:device}}))},2e3)})()}}const _instance=new _Factory,DummyFactory=_instance;_exports.DummyFactory=DummyFactory;_exports.$dummyFactory={DummyFactory:DummyFactory};class Thingy52Device extends BaseDevice{constructor(btDevice){super("Thingy52",`${btDevice.id}`);this.initialize=this.initialize.bind(this);this._btDevice=btDevice;this._onTemperatureChange=this._onTemperatureChange.bind(this);this._onAccelChange=this._onAccelChange.bind(this);this._onButtonChange=this._onButtonChange.bind(this);this._setRGB=this._setRGB.bind(this)}initialize(){var _this4=this;return babelHelpers.asyncToGenerator(function*(){console.log(`Initializing ${_this4.deviceType} device with id: ${_this4.deviceId}`);const server=yield _this4._btDevice.gatt.connect();yield _this4._startTemperatureNotifications(server);yield _this4._startAccelerometerNotifications(server);yield _this4._startButtonClickNotifications(server);_this4._rgbled=yield _this4._getLedCharacteristic(server);_this4._btDevice.ongattserverdisconnected=()=>_this4._deviceDisconnected();_this4.emitDeviceReady()})()}disconnect(){this._btDevice.gatt.disconnect()}_deviceDisconnected(){console.log(`Disconnected: ${this.deviceId}`);this.emitDeviceDisconnected()}_onAccelChange(event){const target=event.target,accel={x:+target.value.getFloat32(0,!0).toPrecision(5),y:+target.value.getFloat32(4,!0).toPrecision(5),z:+target.value.getFloat32(8,!0).toPrecision(5)};this.emitDebugData({type:"acceleration",value:accel})}_onTemperatureChange(event){const target=event.target,integer=target.value.getUint8(0),decimal=target.value.getUint8(1);this.emitDebugData({type:"temperature",value:parseFloat(`${integer}.${decimal}`)})}_onButtonChange(event){const target=event.target,buttonPressed=1===target.value.getUint8(0);this.emitDebugData({type:"button",value:buttonPressed});this.setAlertLevel(buttonPressed?4:1)}_setRGB(value){if(this._rgbled){const color=(hex=>hex.match(/[A-Za-z0-9]{2}/g).map(v=>parseInt(v,16)))(value);return this._rgbled.writeValue(new Uint8Array([1,...color]))}}_startTemperatureNotifications(server){var _this5=this;return babelHelpers.asyncToGenerator(function*(){const service=yield server.getPrimaryService("ef680200-9b35-4933-9b10-52ffa9740042"),characteristic=yield service.getCharacteristic("ef680201-9b35-4933-9b10-52ffa9740042");characteristic.addEventListener("characteristicvaluechanged",_this5._onTemperatureChange);return characteristic.startNotifications()})()}_startAccelerometerNotifications(server){var _this6=this;return babelHelpers.asyncToGenerator(function*(){const service=yield server.getPrimaryService("ef680400-9b35-4933-9b10-52ffa9740042"),characteristic=yield service.getCharacteristic("ef68040a-9b35-4933-9b10-52ffa9740042");characteristic.addEventListener("characteristicvaluechanged",_this6._onAccelChange);return characteristic.startNotifications()})()}_startButtonClickNotifications(server){var _this7=this;return babelHelpers.asyncToGenerator(function*(){const service=yield server.getPrimaryService("ef680300-9b35-4933-9b10-52ffa9740042"),characteristic=yield service.getCharacteristic("ef680302-9b35-4933-9b10-52ffa9740042");characteristic.addEventListener("characteristicvaluechanged",_this7._onButtonChange);return characteristic.startNotifications()})()}_getLedCharacteristic(server){return babelHelpers.asyncToGenerator(function*(){const service=yield server.getPrimaryService("ef680300-9b35-4933-9b10-52ffa9740042");return yield service.getCharacteristic("ef680301-9b35-4933-9b10-52ffa9740042")})()}}_exports.Thingy52Device=Thingy52Device;_exports.$thingy52Device={Thingy52Device:Thingy52Device};class _Factory$1 extends EventTarget{constructor(){super();this.type="Thingy52";console.log(`Created factory for: ${this.type}`)}scan(){var _this8=this;return babelHelpers.asyncToGenerator(function*(){try{const bluetoothDevice=yield navigator.bluetooth.requestDevice({filters:[{services:["ef680100-9b35-4933-9b10-52ffa9740042"]}],optionalServices:["ef680200-9b35-4933-9b10-52ffa9740042","ef680300-9b35-4933-9b10-52ffa9740042","ef680400-9b35-4933-9b10-52ffa9740042","ef680500-9b35-4933-9b10-52ffa9740042"]}),device=new Thingy52Device(bluetoothDevice);_this8.dispatchEvent(new CustomEvent("connect",{detail:{device:device}}))}catch(err){console.log(err)}})()}}const _instance$1=new _Factory$1,Thing52Factory=_instance$1;_exports.Thing52Factory=Thing52Factory;_exports.$thingy52Factory={Thing52Factory:Thing52Factory};class EmpiriKitDevice extends BaseDevice{constructor(usbDevice){super("EmpiriKit",`${usbDevice.serialNumber}`);this.initialize=this.initialize.bind(this);this._startDataStream=this._startDataStream.bind(this);this._readFromDevice=this._readFromDevice.bind(this);this._handleMessage=this._handleMessage.bind(this);this._usbDevice=usbDevice;this._setRGB=this._setRGB.bind(this)}initialize(){console.log(`Initializing ${this.deviceType} device with id: ${this.deviceId}`);this._usbDevice.open().then(()=>this._usbDevice.selectConfiguration(1)).then(()=>this._usbDevice.claimInterface(2)).then(()=>this._usbDevice.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:2})).then(()=>{this.rstring="";setTimeout(this._startDataStream,500);this._readFromDevice()}).catch(error=>{console.log(error)})}_readFromDevice(){this._usbDevice.transferIn(5,64).then(result=>{const decoder=new TextDecoder;this.rstring+=decoder.decode(result.data);const startIdx=this.rstring.indexOf("{");if(0<startIdx)this.rstring=this.rstring.substring(startIdx);const endIdx=this.rstring.indexOf("}");if(-1<endIdx){const parseStr=this.rstring.substring(0,endIdx+1);this.rstring=this.rstring.substring(endIdx+1);try{const msg=JSON.parse(parseStr);this._handleMessage(msg)}catch(e){console.log("NOT JSON:",parseStr)}this.rstring=""}this._readFromDevice()}).catch(error=>{console.log(error);this.emitDeviceDisconnected();this.rstring=""})}sendCMD(string){let data=new TextEncoder("utf-8").encode(string);if(this._usbDevice){this._usbDevice.transferOut(5,data)}}_startDataStream(){this.sendCMD("{\"STRACC\":1}");this.sendCMD("{\"STRTCH\":1}")}_handleMessage(data){if("StreamData"===data.datatype){this.tick=data.tick;let accelData=data.accelerometerdata,touchData=data.touchsensordata;if(accelData!==void 0){const deviceId=this._usbDevice.serialNumber,accelFactor=9.82/(1<<14),accel={x:+accelData[0]*accelFactor,y:-accelData[1]*accelFactor,z:+accelData[2]*accelFactor}}if(touchData!==void 0&&this._lastTouchData!=touchData){const tmpAlertLevel=_Mathround(4*touchData/40);if(tmpAlertLevel!=this._alertLevel){this.setAlertLevel(tmpAlertLevel)}this._lastTouchData=touchData}}else if("HardwareInfo"===data.datatype){this.capabilities=data.capabilities;this.uid=data.uid;this.version=data.version}}_setRGB(value){const color=(hex=>hex.match(/[A-Za-z0-9]{2}/g).map(v=>parseInt(v,16)))(value);this.sendCMD(`{"SETRGB":${JSON.stringify(color)}}`)}disconnect(){this._usbDevice.close()}}_exports.EmpiriKitDevice=EmpiriKitDevice;_exports.$empirikitDevice={EmpiriKitDevice:EmpiriKitDevice};const empiriKitUSBID={VID:4617,PID:53271};class _Factory$2 extends EventTarget{constructor(){super();this.type="empiriKit";console.log(`Created factory for: ${this.type}`);this.initialize()}initialize(){navigator.usb.getDevices().then(availableDevices=>{console.log(availableDevices);for(let usbDevice of availableDevices){if(usbDevice.vendorId===empiriKitUSBID.VID&&usbDevice.productId===empiriKitUSBID.PID){const device=new EmpiriKitDevice(usbDevice);this.dispatchEvent(new CustomEvent("connect",{detail:{device:device}}))}}throw"no device available yet"}).catch(error=>{console.log(error)});navigator.usb.addEventListener("connect",evt=>{console.log("something connected!");const device=new EmpiriKitDevice(evt.device);this.dispatchEvent(new CustomEvent("connect",{detail:{device:device}}))})}scan(){navigator.usb.requestDevice({filters:[{vendorId:empiriKitUSBID.VID,productId:empiriKitUSBID.PID}]}).then(selectedDevice=>{const device=new EmpiriKitDevice(selectedDevice);this.dispatchEvent(new CustomEvent("connect",{detail:{device:device}}))}).catch(error=>{console.log(error)})}}const _instance$2=new _Factory$2,EmpiriKitFactory=_instance$2;_exports.EmpiriKitFactory=EmpiriKitFactory;_exports.$empirikitFactory={EmpiriKitFactory:EmpiriKitFactory};class FakeMesh extends EventTarget{constructor(){super();this.devices=new Map;this._meshAlertLevel=1;this.onConnect=this.onConnect.bind(this);this.onDisconnect=this.onDisconnect.bind(this);this.onDebugData=this.onDebugData.bind(this);this.onDebugAlertLevel=this.onDebugAlertLevel.bind(this);this.factories=new Map;this.factories.set(DummyFactory.type,DummyFactory);this.factories.set(Thing52Factory.type,Thing52Factory);this.factories.set(EmpiriKitFactory.type,EmpiriKitFactory);for(let factory of this.factories.values()){factory.addEventListener("connect",this.onConnect)}}factoryTypes(){return this.factories.keys()}scanFor(type){if(!this.factories.has(type)){throw`No factory registered for ${type}`}this.factories.get(type).scan()}disconnect(deviceId){const device=this.devices.get(deviceId);if(device){device.disconnect()}}onConnect(evt){const device=evt.detail.device;device.addEventListener("disconnect",this.onDisconnect);device.addEventListener("debug-data",this.onDebugData);device.addEventListener("debug-state-value-changed",this.onDebugStateValueChanged);device.addEventListener("debug-alert-level",this.onDebugAlertLevel);device.initialize();this.devices.set(device.deviceId,device);this.dispatchEvent(new CustomEvent("device-connected",{detail:device}));this.dispatchEvent(new CustomEvent("debug-msg",{detail:`[connect] Now there are ${this.devices.size} devices in the mesh`}))}onDisconnect(evt){const device=evt.target;this.devices.delete(device.deviceId);this.dispatchEvent(new CustomEvent("device-disconnected",{detail:device}));this.dispatchEvent(new CustomEvent("debug-msg",{detail:`[disconnect] Now there are ${this.devices.size} devices in the mesh`}))}setStateValue(deviceId,key,value){const device=this.devices.get(deviceId);if(device){device.setStateValue(key,value)}}getStateValue(deviceId,key){const device=this.devices.get(deviceId);if(device){return device.getStateValue(key)}}getDeviceIds(){return Array.from(this.devices.keys())}getDevice(deviceId){return this.devices.get(deviceId)}getDevices(){return this.devices}onDebugData(evt){const device=evt.target;if(["temperature","button","heartbeat"].includes(evt.detail.type)){console.log(device,evt.detail)}}onDebugStateValueChanged(evt){const device=evt.target;console.log(`${device.deviceId} changed '${evt.detail.key}' from '${JSON.stringify(evt.detail.from)}' to '${JSON.stringify(evt.detail.to)}'`)}onDebugAlertLevel(evt){const src=evt.target,level=evt.detail.level;let sum=0;for(let device of this.devices.values()){sum+=device.getAlertLevel()}const tmpLevel=_Mathround(sum/this.devices.size);if(tmpLevel!==this._meshAlertLevel){this._meshAlertLevel=tmpLevel;this.dispatchEvent(new CustomEvent("debug-mesh-alert-level",{detail:{level:this._meshAlertLevel,visual:AlertLevels[this._meshAlertLevel]}}))}}}const fakeMesh=new FakeMesh,Mesh=fakeMesh;_exports.Mesh=Mesh;_exports.$fakeMesh={Mesh:Mesh};const drawdata={pens:[],guides:[],min:-10,max:10,topmargin:8,bottommargin:8,resolution:50,running:!0};let graph=null;function addPen(id,options){if(drawdata.pens[id]){console.log("Pen already added: ",id)}drawdata.pens[id]={color:options.color?options.color:"#000",name:options.name?options.name:"",line:!options.dotsOnly,lineWidth:options.lineWidth?options.lineWidth:1,data:[]}}function addGuide(id,options){if(drawdata.guides[id]){console.log("Guide already added: ",id);return}if(!options||options.min===void 0){console.log("Guide needs at least a 'min' value defined");return}drawdata.guides[id]={color:options.color?options.color:"#888",name:options.name?options.name:"",min:options.min,height:options.height}}function addValue(id,value,timestamp){var pen=drawdata.pens[id];if(!pen)return;if(!timestamp)timestamp=Date.now();if(0<pen.data.length&&pen.data[pen.data.length-1].t>=timestamp)return;pen.data.push({v:value,t:timestamp})}function _recalcFactors(){drawdata._ya=-(graph.height-drawdata.bottommargin-drawdata.topmargin)/(drawdata.max-drawdata.min);drawdata._yb=drawdata.topmargin-drawdata._ya*drawdata.max}function _calcY(val){return drawdata._ya*val+drawdata._yb}function _calcPos(point,pos,now){pos.x=graph.width-5-.001*(now-point.t)*drawdata.resolution;pos.y=drawdata._ya*point.v+drawdata._yb}function _gameLoop(){_repaint(Date.now());if(drawdata.running)requestAnimationFrame(_gameLoop)}function _repaint(now){var _MathPI=Math.PI,ctx=graph.getContext("2d");ctx.clearRect(0,0,graph.width,graph.height);var id,pen,guide,ptr,pos={},dots=[];for(id in drawdata.guides){guide=drawdata.guides[id];if(guide.height!==void 0){ctx.fillStyle=guide.color;ctx.fillRect(0,_calcY(guide.min),graph.width,drawdata._ya*guide.height)}else{ctx.beginPath();ctx.strokeStyle=guide.color;ctx.moveTo(0,_calcY(guide.min));ctx.lineTo(graph.width,_calcY(guide.min));ctx.stroke()}}for(id in drawdata.pens){pen=drawdata.pens[id];if(pen.data&&1<pen.data.length){ctx.beginPath();ctx.lineWidth=pen.lineWidth;ptr=pen.data.length-1;_calcPos(pen.data[ptr],pos,now);if(pen.line){ctx.strokeStyle=pen.color;ctx.moveTo(pos.x,pos.y);dots.push({x:graph.width-5,y:pos.y,color:pen.color})}else{ctx.fillStyle=pen.color}while(0<=ptr&&0<pos.x){_calcPos(pen.data[ptr],pos,now);if(pen.line)ctx.lineTo(pos.x,pos.y);else{ctx.beginPath();ctx.arc(pos.x,pos.y,4,0,2*_MathPI,!1);ctx.fill()}ptr--}if(pen.line)ctx.stroke()}}ctx.lineWidth=1;dots.forEach(function(dot){ctx.beginPath();ctx.arc(dot.x,dot.y,4,0,2*_MathPI,!1);ctx.fillStyle=dot.color;ctx.fill()})}class BackgroundView extends LitElement{static get properties(){return{selected:{type:Number,reflect:!0}}}render(){return html`
        <style>
        :host {
            font-family: 'Ubuntu', sans-serif;
            padding:0;
            margin:0;
        }

        .content {
            position: fixed;
            margin:0;
            padding:0;
            width: 100%;
            height:100%;
            display:flex;
            align-items: center;
            flex-direction: column;
            opacity: 0;
            transition: opacity 300ms ease-out;
        }

        .show {
            opacity: 1;
        }

        #graph {
            background: rgba(20,20,20,0.6);
            margin:0;
            padding:0;
            width: 80%;
            height: 50%;
        }


        </style>
        <div class="content ${0===this.selected?"show":""}">
            <h1>GRAPH</h1>
            <canvas id="graph"></canvas>
        </div>
        <div class="content ${1===this.selected?"show":""}">
            <img style="width:80%" src="/images/siteview.jpg"/>
        </div>
        <div class="content ${2===this.selected?"show":""}">
        <img style="width:80%" src="/images/arview.jpg"/>
        </div>
        `}constructor(){super();this.selected=0}firstUpdated(){graph=this.shadowRoot.querySelector("#graph");addGuide("zero_guide",{min:0,name:"ZERO"});addPen("defcon",{color:"#ffffff",name:"defcon",lineWidth:3});addPen("x",{color:"#ff0000",name:"x",lineWidth:3});addPen("y",{color:"#00ff00",name:"y",lineWidth:3});addPen("z",{color:"#0000ff",name:"z",lineWidth:3});const ro=new ResizeObserver(entries=>{var _Mathceil=Math.ceil;for(let entry of entries){const cr=entry.contentRect;graph._width=_Mathceil(cr.width);graph._height=_Mathceil(cr.height);graph.setAttribute("width",graph._width);graph.setAttribute("height",graph._height);_recalcFactors()}});ro.observe(graph);_recalcFactors();requestAnimationFrame(_gameLoop);Mesh.addEventListener("debug-mesh-alert-level",evt=>{addValue("defcon",2*evt.detail.level-2)})}}_exports.BackgroundView=BackgroundView;customElements.define("background-view",BackgroundView);_exports.$backgroundView={BackgroundView:BackgroundView};class ControlButton extends LitElement{static get properties(){return{selected:{type:Boolean,reflect:!0},toggle:{type:Boolean,reflect:!0}}}render(){return html`
        <style>
        :host {
            display: inline-block;
            margin:0;
            padding:0;
            font-family: 'Ubuntu', sans-serif;
        }

        .button {
            display: inline-block;
            margin: 0;
            margin-right: 2px;
            padding: 0;
            width: 120px;
            height: 80px;
            background: rgba(20,20,20,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        ::slotted(*) {
            margin: 10px;
            width: 60px;
            height: 60px;
        }

        .selected {
            background: rgba(20,20,200,0.8);
        }

        </style>
        <div class="button ${this.selected?"selected":""}" @click="${this._onClick}">
             <slot></slot>
        </div>
        `}constructor(){super();this.toggle=!1;this.selected=!0;this._onClick=this._onClick.bind(this)}firstUpdated(){console.log("firstUpdated",this,this.position,this.opened)}_onClick(){if(this.toggle){this.selected=!this.selected;this.dispatchEvent(new CustomEvent("toggled",{detail:this.selected}))}}}_exports.ControlButton=ControlButton;customElements.define("control-button",ControlButton);_exports.$controlButton={ControlButton:ControlButton}});